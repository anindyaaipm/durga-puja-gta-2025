<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Durga Puja 2025 Guide - GTA</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Leaflet CSS for interactive map -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <!-- Google Fonts for festive typography -->
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Open+Sans:wght@300;400;600&display=swap" rel="stylesheet">
    
    <style>
        /* ===== FESTIVE DURGA PUJA THEME ===== */
        :root {
            --primary-red: #d32f2f;
            --gold: #ffd700;
            --white: #ffffff;
            --light-red: #ffebee;
            --dark-red: #b71c1c;
            --text-dark: #2c3e50;
        }

        body {
            font-family: 'Open Sans', sans-serif;
            background: linear-gradient(135deg, var(--light-red) 0%, var(--white) 100%);
            min-height: 100vh;
        }

        /* ===== HEADER STYLING ===== */
        .header {
            background: linear-gradient(135deg, var(--primary-red) 0%, var(--dark-red) 100%);
            color: var(--white);
            padding: 2rem 0;
            text-align: center;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
        }

        .header h1 {
            font-family: 'Playfair Display', serif;
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        /* ===== HEADER DECORATIONS ===== */
        .header-decoration {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .header-icon {
            font-size: 3rem;
            color: var(--gold);
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            animation: pulse 2s infinite;
        }

        .decoration-dots {
            display: flex;
            gap: 8px;
        }

        .dot {
            width: 8px;
            height: 8px;
            background: var(--gold);
            border-radius: 50%;
            animation: twinkle 1.5s infinite;
        }

        .dot:nth-child(2) {
            animation-delay: 0.3s;
        }

        .dot:nth-child(3) {
            animation-delay: 0.6s;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.3; transform: scale(0.8); }
            50% { opacity: 1; transform: scale(1.2); }
        }

        @media (max-width: 768px) {
            .header-icon {
                font-size: 2.5rem;
            }
        }

        /* ===== INTRO SECTION ===== */
        .intro-section {
            background: var(--white);
            padding: 3rem 0;
            margin: 2rem 0;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }

        .intro-section h2 {
            color: var(--primary-red);
            font-family: 'Playfair Display', serif;
            margin-bottom: 1.5rem;
        }

        .intro-credit {
            margin-top: 2rem;
            padding-top: 1.5rem;
            border-top: 1px solid var(--light-red);
        }

        .intro-credit-link {
            color: #FF6B35;
            text-decoration: none;
            font-weight: 700;
            font-size: 1.1em;
            transition: all 0.3s ease;
        }

        .intro-credit-link:hover {
            color: var(--primary-red);
            text-decoration: underline;
            transform: translateY(-1px);
        }

        .intro-credit p {
            font-weight: 600;
        }

        /* ===== SEARCH AND FILTER SECTION ===== */
        .search-section {
            background: var(--white);
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
        }

        .search-input {
            border: 2px solid var(--light-red);
            border-radius: 25px;
            padding: 0.75rem 1.5rem;
            font-size: 1.1rem;
        }

        .search-input:focus {
            border-color: var(--primary-red);
            box-shadow: 0 0 0 0.2rem rgba(211, 47, 47, 0.25);
        }

        .search-info {
            display: flex;
            align-items: center;
            height: 100%;
            justify-content: center;
        }

        /* ===== FOOTER STYLING ===== */
        .footer {
            background: var(--white);
            color: var(--text-dark);
            text-align: center;
            padding: 2rem 0;
            margin-top: 3rem;
            border-top: 3px solid var(--primary-red);
        }

        .footer h3 {
            font-family: 'Playfair Display', serif;
            margin-bottom: 0.5rem;
            color: var(--primary-red);
        }

        .footer-link {
            color: #FF6B35;
            text-decoration: none;
            font-weight: 700;
            font-size: 1.1em;
            transition: all 0.3s ease;
        }

        .footer-link:hover {
            color: var(--primary-red);
            text-decoration: underline;
            transform: translateY(-1px);
        }

        .acknowledgement {
            font-weight: 600;
        }

        /* ===== FLOATING ITINERARY BUTTON ===== */
        .floating-itinerary-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--primary-red);
            color: var(--white);
            border: none;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
            cursor: pointer;
            z-index: 1000;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .floating-itinerary-btn:hover {
            background: var(--dark-red);
            transform: scale(1.1);
        }

        .itinerary-count {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--gold);
            color: var(--text-dark);
            border-radius: 50%;
            width: 25px;
            height: 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: 700;
        }

        /* ===== ITINERARY SIDEBAR ===== */
        .itinerary-sidebar {
            position: fixed;
            top: 0;
            right: -400px;
            width: 400px;
            height: 100vh;
            background: var(--white);
            box-shadow: -5px 0 20px rgba(0,0,0,0.3);
            z-index: 1001;
            transition: right 0.3s ease;
            overflow-y: auto;
        }

        .itinerary-sidebar.open {
            right: 0;
        }

        .sidebar-header {
            background: var(--primary-red);
            color: var(--white);
            padding: 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .sidebar-header h4 {
            margin: 0;
            font-family: 'Playfair Display', serif;
        }

        .close-sidebar {
            background: none;
            border: none;
            color: var(--white);
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 50%;
            transition: background 0.3s ease;
        }

        .close-sidebar:hover {
            background: rgba(255,255,255,0.2);
        }

        .sidebar-content {
            padding: 1.5rem;
        }

        .itinerary-list {
            margin-bottom: 2rem;
        }

        .itinerary-item {
            background: var(--light-red);
            padding: 1rem;
            border-radius: 10px;
            margin-bottom: 1rem;
            border-left: 4px solid var(--primary-red);
        }

        .itinerary-item h6 {
            color: var(--primary-red);
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .itinerary-item p {
            margin: 0;
            font-size: 0.9rem;
            color: var(--text-dark);
        }

        .sidebar-actions {
            border-top: 1px solid var(--light-red);
            padding-top: 1.5rem;
        }

        .sidebar-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .sidebar-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        /* ===== RESPONSIVE ITINERARY ===== */
        @media (max-width: 768px) {
            .itinerary-sidebar {
                width: 100%;
                right: -100%;
            }
            
            .floating-itinerary-btn {
                bottom: 20px;
                right: 20px;
                width: 50px;
                height: 50px;
                font-size: 1.2rem;
            }
        }

        /* ===== FLOATING ITINERARY BUTTON ===== */
        .floating-itinerary-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--primary-red);
            color: var(--white);
            border: none;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
            cursor: pointer;
            z-index: 1000;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .floating-itinerary-btn:hover {
            background: var(--dark-red);
            transform: scale(1.1);
        }

        .itinerary-count {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--gold);
            color: var(--text-dark);
            border-radius: 50%;
            width: 25px;
            height: 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: 700;
        }

        /* ===== ITINERARY SIDEBAR ===== */
        .itinerary-sidebar {
            position: fixed;
            top: 0;
            right: -400px;
            width: 400px;
            height: 100vh;
            background: var(--white);
            box-shadow: -5px 0 20px rgba(0,0,0,0.3);
            z-index: 1001;
            transition: right 0.3s ease;
            overflow-y: auto;
        }

        .itinerary-sidebar.open {
            right: 0;
        }

        .sidebar-header {
            background: var(--primary-red);
            color: var(--white);
            padding: 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .sidebar-header h4 {
            margin: 0;
            font-family: 'Playfair Display', serif;
        }

        .close-sidebar {
            background: none;
            border: none;
            color: var(--white);
            font-size: 1.5rem;
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 50%;
            transition: background 0.3s ease;
        }

        .close-sidebar:hover {
            background: rgba(255,255,255,0.2);
        }

        .sidebar-content {
            padding: 1.5rem;
        }

        .itinerary-list {
            margin-bottom: 2rem;
        }

        .itinerary-item {
            background: var(--light-red);
            padding: 1rem;
            border-radius: 10px;
            margin-bottom: 1rem;
            border-left: 4px solid var(--primary-red);
        }

        .itinerary-item h6 {
            color: var(--primary-red);
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .itinerary-item p {
            margin: 0;
            font-size: 0.9rem;
            color: var(--text-dark);
        }

        .sidebar-actions {
            border-top: 1px solid var(--light-red);
            padding-top: 1.5rem;
        }

        .sidebar-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .sidebar-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        /* ===== RESPONSIVE ITINERARY ===== */
        @media (max-width: 768px) {
            .itinerary-sidebar {
                width: 100%;
                right: -100%;
            }
            
            .floating-itinerary-btn {
                bottom: 20px;
                right: 20px;
                width: 50px;
                height: 50px;
                font-size: 1.2rem;
            }
        }

        /* ===== PUJA TABLE/CARDS STYLING ===== */
        .puja-container {
            background: var(--white);
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .puja-table {
            margin: 0;
        }

        .puja-table th {
            background: var(--primary-red);
            color: var(--white);
            border: none;
            padding: 1rem;
            font-weight: 600;
            text-align: center;
        }

        .puja-table th:first-child {
            width: 120px;
        }

        .puja-table td {
            padding: 1rem;
            vertical-align: middle;
            border-color: var(--light-red);
        }

        .puja-table td:first-child {
            text-align: center;
        }

        .puja-table tbody tr:hover {
            background-color: var(--light-red);
            transition: background-color 0.3s ease;
        }

        /* ===== PUJA CARDS (MOBILE VIEW) ===== */
        .puja-card {
            background: var(--white);
            border: 2px solid var(--light-red);
            border-radius: 15px;
            margin-bottom: 1.5rem;
            padding: 1.5rem;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .puja-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .puja-card .card-title {
            color: var(--primary-red);
            font-family: 'Playfair Display', serif;
            font-size: 1.4rem;
            margin-bottom: 1rem;
        }

        .puja-card .card-text {
            color: var(--text-dark);
            margin-bottom: 0.5rem;
        }

        .puja-card .facebook-link {
            color: #1877f2;
            text-decoration: none;
            font-weight: 600;
        }

        .puja-card .facebook-link:hover {
            text-decoration: underline;
        }

        /* ===== CHECKBOX STYLING ===== */
        .form-check-input:checked {
            background-color: var(--primary-red);
            border-color: var(--primary-red);
        }

        .form-check-input:focus {
            border-color: var(--primary-red);
            box-shadow: 0 0 0 0.2rem rgba(211, 47, 47, 0.25);
        }

        /* ===== ITINERARY SIDEBAR ===== */
        .itinerary-sidebar {
            position: fixed;
            top: 0;
            right: -400px;
            width: 400px;
            height: 100vh;
            background: var(--white);
            box-shadow: -5px 0 25px rgba(0,0,0,0.2);
            transition: right 0.3s ease;
            z-index: 1050;
            overflow-y: auto;
        }

        .itinerary-sidebar.show {
            right: 0;
        }

        .itinerary-header {
            background: var(--primary-red);
            color: var(--white);
            padding: 1.5rem;
            text-align: center;
        }

        .itinerary-content {
            padding: 1.5rem;
        }

        .itinerary-item {
            background: var(--light-red);
            border-radius: 10px;
            padding: 1rem;
            margin-bottom: 1rem;
            border-left: 4px solid var(--primary-red);
        }

        .itinerary-item h6 {
            color: var(--primary-red);
            font-weight: 600;
            margin-bottom: 0.5rem;
        }

        .itinerary-item p {
            margin: 0;
            font-size: 0.9rem;
            color: var(--text-dark);
        }

        /* ===== FLOATING ITINERARY BUTTON ===== */
        .floating-itinerary-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: var(--primary-red);
            color: var(--white);
            border: none;
            border-radius: 50px;
            padding: 15px 25px;
            font-size: 1.1rem;
            font-weight: 600;
            box-shadow: 0 8px 25px rgba(211, 47, 47, 0.3);
            transition: all 0.3s ease;
            z-index: 1040;
        }

        .floating-itinerary-btn:hover {
            background: var(--dark-red);
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(211, 47, 47, 0.4);
        }

        .itinerary-count {
            background: var(--gold);
            color: var(--text-dark);
            border-radius: 50%;
            width: 25px;
            height: 25px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: 700;
            margin-left: 10px;
        }

        /* ===== SHARE BUTTONS ===== */
        .share-buttons {
            margin-top: 1.5rem;
            text-align: center;
        }

        .share-btn {
            margin: 0.5rem;
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 25px;
            font-weight: 600;
            text-decoration: none;
            display: inline-block;
            transition: all 0.3s ease;
        }

        .share-btn.whatsapp {
            background: #25d366;
            color: white;
        }

        .share-btn.facebook {
            background: #1877f2;
            color: white;
        }

        .share-btn.email {
            background: var(--primary-red);
            color: white;
        }

        .share-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        /* ===== FOOTER ===== */
        .footer {
            background: var(--primary-red);
            color: var(--white);
            text-align: center;
            padding: 2rem 0;
            margin-top: 3rem;
        }

        .footer h3 {
            font-family: 'Playfair Display', serif;
            margin-bottom: 0.5rem;
        }

        /* ===== OVERLAY FOR SIDEBAR ===== */
        .sidebar-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1040;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .sidebar-overlay.show {
            opacity: 1;
            visibility: visible;
        }

        /* ===== RESPONSIVE DESIGN ===== */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .itinerary-sidebar {
                width: 100%;
                right: -100%;
            }
            
            .floating-itinerary-btn {
                bottom: 20px;
                right: 20px;
                padding: 12px 20px;
                font-size: 1rem;
            }
            
            .puja-table {
                display: none;
            }
            
            .puja-cards {
                display: block;
            }
        }

        @media (min-width: 769px) {
            .puja-cards {
                display: none;
            }
        }

        /* ===== UTILITY CLASSES ===== */
        .text-festive {
            color: var(--primary-red);
        }

        .bg-festive {
            background-color: var(--light-red);
        }

        .btn-festive {
            background-color: var(--primary-red);
            border-color: var(--primary-red);
            color: white;
        }

        .btn-festive:hover {
            background-color: var(--dark-red);
            border-color: var(--dark-red);
        }

        /* ===== INTERACTIVE MAP SECTION ===== */
        .map-section {
            background: var(--light-red);
            padding: 3rem 0;
            margin-top: 3rem;
        }

        .map-container {
            background: var(--white);
            border-radius: 15px;
            padding: 1rem;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .puja-map {
            height: 500px;
            width: 100%;
            border-radius: 10px;
        }

        /* Custom map marker styles */
        .custom-marker {
            background: var(--primary-red);
            border: 3px solid var(--white);
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--white);
            font-weight: bold;
            font-size: 14px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        .custom-marker:hover {
            background: var(--dark-red);
            transform: scale(1.1);
            transition: all 0.3s ease;
        }

        /* Map popup styling */
        .leaflet-popup-content-wrapper {
            border-radius: 10px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.2);
        }

        .leaflet-popup-content {
            margin: 15px;
            font-family: 'Open Sans', sans-serif;
        }

        .popup-title {
            color: var(--primary-red);
            font-weight: 600;
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
        }

        .popup-details {
            margin-bottom: 1rem;
        }

        .popup-details p {
            margin: 0.25rem 0;
            font-size: 0.9rem;
        }

        .popup-actions {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .popup-btn {
            padding: 0.25rem 0.5rem;
            font-size: 0.8rem;
            border-radius: 5px;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.25rem;
        }

        .popup-btn:hover {
            text-decoration: none;
        }

        .btn-directions {
            background: var(--primary-red);
            color: var(--white);
        }

        .btn-directions:hover {
            background: var(--dark-red);
            color: var(--white);
        }

        .btn-facebook {
            background: #1877f2;
            color: var(--white);
        }

        .btn-facebook:hover {
            background: #166fe5;
            color: var(--white);
        }

        .btn-website {
            background: var(--gold);
            color: var(--text-dark);
        }

        .btn-website:hover {
            background: #e6b800;
            color: var(--text-dark);
        }

        /* ===== RESPONSIVE MAP ===== */
        @media (max-width: 768px) {
            .puja-map {
                height: 400px;
            }
            
            .map-section {
                padding: 2rem 0;
            }
            
            .popup-actions {
                flex-direction: column;
            }
            
            .popup-btn {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <!-- ===== HEADER SECTION ===== -->
    <header class="header">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-2 text-center d-none d-md-block">
                    <div class="header-decoration">
                        <i class="fas fa-om header-icon"></i>
                        <div class="decoration-dots">
                            <span class="dot"></span>
                            <span class="dot"></span>
                            <span class="dot"></span>
                        </div>
                    </div>
                </div>
                <div class="col-md-8 text-center">
                    <h1><i class="fas fa-om"></i> Durga Puja 2025 Guide</h1>
                    <p class="subtitle">Discover and plan your Durga Puja celebrations across the Greater Toronto Area</p>
                </div>
                <div class="col-md-2 text-center d-none d-md-block">
                    <div class="header-decoration">
                        <i class="fas fa-om header-icon"></i>
                        <div class="decoration-dots">
                            <span class="dot"></span>
                            <span class="dot"></span>
                            <span class="dot"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- ===== MAIN CONTENT ===== -->
    <div class="container">
        <!-- ===== INTRO SECTION ===== -->
        <section class="intro-section">
            <div class="container">
                <h2 class="text-center">Welcome to Durga Puja 2025</h2>
                <p class="lead text-center">
                    Explore the vibrant Durga Puja celebrations happening across the Greater Toronto Area. 
                    Find puja details, dates, locations, and create your personalized itinerary to make the most of this festive season.
                </p>
                <div class="intro-credit text-center">
                    <p>
                        <small>
                            Created with ❤️ by 
                            <a href="https://www.youtube.com/@NodesofTravel" target="_blank" class="intro-credit-link">
                                <i class="fab fa-youtube"></i> Nodes of Travel
                            </a>
                        </small>
                    </p>
                </div>
            </div>
        </section>

        <!-- ===== SEARCH SECTION ===== -->
        <section class="search-section">
            <div class="row">
                <div class="col-md-6">
                    <div class="input-group">
                        <span class="input-group-text bg-festive text-white">
                            <i class="fas fa-search"></i>
                        </span>
                        <input type="text" class="form-control search-input" id="searchInput" 
                               placeholder="Search by puja name, location, or date...">
                    </div>
                </div>
                <div class="col-md-3">
                    <select class="form-select" id="sortSelect">
                        <option value="name">Sort by Name</option>
                        <option value="date">Sort by Date</option>
                    </select>
                </div>
                <div class="col-md-3">
                    <div class="search-info">
                        <small class="text-muted">
                            <i class="fas fa-info-circle"></i> 
                            Found <span id="resultCount">21</span> pujas
                        </small>
                    </div>
                </div>
            </div>
        </section>

        <!-- ===== PUJA LISTING SECTION ===== -->
        <section class="puja-container">
            <!-- Desktop Table View -->
            <div class="table-responsive">
                <table class="table puja-table" id="pujaTable">
                    <thead>
                        <tr>
                            <th>Add to Itinerary</th>
                            <th>Puja Name</th>
                            <th>Date(s)</th>
                            <th>Address</th>
                            <th>Facebook Link or Website</th>
                        </tr>
                    </thead>
                    <tbody id="pujaTableBody">
                        <!-- Puja data will be populated by JavaScript -->
                    </tbody>
                </table>
            </div>

            <!-- Mobile Card View -->
            <div class="puja-cards" id="pujaCards">
                <!-- Puja cards will be populated by JavaScript -->
            </div>
        </section>

        <!-- ===== INTERACTIVE MAP SECTION ===== -->
        <section class="map-section">
            <div class="container">
                <div class="row">
                    <div class="col-12">
                        <h2 class="section-title text-center mb-4">
                            <i class="fas fa-map-marked-alt text-festive"></i>
                            Interactive Puja Map
                        </h2>
                        <p class="text-center text-muted mb-4">
                            Click on the markers to see puja details and get directions
                        </p>
                    </div>
                </div>
                <div class="row">
                    <div class="col-12">
                        <div class="map-container">
                            <div id="pujaMap" class="puja-map"></div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>


      <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Leaflet JS for interactive map -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    

    <!-- ===== FLOATING ITINERARY BUTTON ===== -->
    <button class="floating-itinerary-btn" id="itineraryBtn">
        <i class="fas fa-list"></i>
        <span class="itinerary-count" id="itineraryCount">0</span>
    </button>

    <!-- ===== ITINERARY SIDEBAR ===== -->
    <div class="itinerary-sidebar" id="itinerarySidebar">
        <div class="sidebar-header">
            <h4><i class="fas fa-route"></i> My Itinerary</h4>
            <button class="close-sidebar" id="closeSidebar">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="sidebar-content">
            <div id="itineraryList" class="itinerary-list">
                <p class="text-muted text-center">No pujas selected yet</p>
            </div>
            <div class="sidebar-actions" id="sidebarActions" style="display: none;">
                <button class="btn btn-festive w-100 mb-2" id="shareWhatsApp">
                    <i class="fab fa-whatsapp"></i> Share on WhatsApp
                </button>
                <button class="btn btn-outline-primary w-100 mb-2" id="shareFacebook">
                    <i class="fab fa-facebook"></i> Share on Facebook
                </button>
                <button class="btn btn-outline-success w-100 mb-2" id="shareEmail">
                    <i class="fas fa-envelope"></i> Email Itinerary
                </button>
                <button class="btn btn-outline-secondary w-100" id="copyText">
                    <i class="fas fa-copy"></i> Copy as Text
                </button>
            </div>
        </div>
    </div>

    <!-- ===== SIDEBAR OVERLAY ===== -->
    <div class="sidebar-overlay" id="sidebarOverlay"></div>

    <!-- ===== FOOTER ===== -->
    <footer class="footer">
        <div class="container">
            <div class="row">
                <div class="col-md-8">
                    <h3>Happy Durga Puja!</h3>
                    <p>May this festive season bring joy, prosperity, and blessings to you and your family.</p>
                </div>
                <div class="col-md-4 text-md-end">
                    <p class="acknowledgement">
                        <small>
                            Created with ❤️ by 
                            <a href="https://www.youtube.com/@NodesofTravel" target="_blank" class="footer-link">
                                <i class="fab fa-youtube"></i> Nodes of Travel
                            </a>
                        </small>
                    </p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // ===== PUJA DATA =====
        const pujaData = [
            {
                id: 1,
                name: "Agomoni Cultural Association of Durham",
                dates: "27th - 28th Sep",
                address: "1867 Valley Farm Rd, Pickering, ON L1V 6K7",
                facebook: "https://www.facebook.com/agomoni.ca"
            },
            {
                id: 2,
                name: "Amantran Cultural Association",
                dates: "4th - 5th Oct",
                address: "2155 Liverpool Rd, Pickering, ON L1X 1W1",
                facebook: "https://www.facebook.com/amantran.gta/"
            },
            {
                id: 3,
                name: "Amar Pujo Cultural Association of Toronto",
                dates: "27th - 28th Sep",
                address: "The Pearl Banquet, Mississauga",
                facebook: "https://www.facebook.com/amarpujotoronto"
            },
            {
                id: 4,
                name: "Bangiya Parishad Toronto (BPT)",
                dates: "3rd - 5th Oct",
                address: "140 Millweek Dr, Tagore Centre",
                facebook: "https://www.facebook.com/bangiyaparishad.ca"
            },
            {
                id: 5,
                name: "Bangladesh Canada Hindu Mandir (Dohme Ave)",
                dates: "27th to 1st Oct",
                address: "16 Dohme Ave, East York",
                facebook: "http://hindumondir.org/"
            },
            {
                id: 6,
                name: "Bharatsevasram",
                dates: "27th Sep to 1st Oct",
                address: "2107 Codlin Crescent, Etobicoke",
                facebook: "https://bsstoronto.org/"
            },
            {
                id: 7,
                name: "Bongo Paribar",
                dates: "27th - 28th Sep",
                address: "St. Volodymyr Cultural Centre - SVCC, 1280 Dundas St W, Oakville",
                facebook: "https://www.facebook.com/bongoporibargta"
            },
            {
                id: 8,
                name: "Dhar Barir Pujo",
                dates: "27th to 1st Oct",
                address: "601 Brimley road, Scarborough",
                facebook: "Facebook.com/aritrasdurgapujo"
            },
            {
                id: 9,
                name: "Durba Foundation",
                dates: "27th - 28th Sep",
                address: "1355 Harwood Ave N, Ajax, ON L1T 4G8",
                facebook: "https://www.facebook.com/durba.foundation"
            },
            {
                id: 10,
                name: "Durham Durgotsab",
                dates: "4th - 5th Oct",
                address: "1355 Harwood Ave N, Ajax, ON L1T 4G8",
                facebook: "https://www.facebook.com/durhamdurgotsab"
            },
            {
                id: 11,
                name: "Grand River Cultural Association- GRCA Durga Puja",
                dates: "26th to 28th Sep",
                address: "Conestoga Banquet Hall, 617 King St N, Waterloo",
                facebook: "https://www.facebook.com/profile.php?id=61565494949425"
            },
            {
                id: 12,
                name: "KWGC Durgotsav",
                dates: "26th to 28th Sep",
                address: "St Agatha Community Centre",
                facebook: "https://www.facebook.com/profile.php?id=61552044939816"
            },
            {
                id: 13,
                name: "Royal City Durga Puja",
                dates: "4th - 5th Oct",
                address: "The Guelph Estate, 340 Woodlawn Rd W",
                facebook: "https://www.facebook.com/royalcitydurgapujaguelph"
            },
            {
                id: 14,
                name: "Sanatan Bengali Cultural Association",
                dates: "27th - 28th Sep",
                address: "22 Willow St, Waterloo ON",
                facebook: "https://www.facebook.com/groups/313402081465042/"
            },
            {
                id: 15,
                name: "Toronto Bengali Cultural Society - TBCS",
                dates: "27th - 28th Sep",
                address: "Sankkamam Party Hall, 42 Tuxedo Ct, Scarborough",
                facebook: "https://www.facebook.com/profile.php?id=61564868422075"
            },
            {
                id: 16,
                name: "Toronto Durgabari",
                dates: "27th to 1st Oct",
                address: "427 Birchmount Rd, Scarborough",
                facebook: "https://www.torontodurgabari.com/"
            },
            {
                id: 17,
                name: "Toronto Hindu Dharmashram",
                dates: "27th Sep to 1st Oct",
                address: "1510 Birchmount Rd, Scarborough",
                facebook: "http://www.hindudharmasram.com/"
            },
            {
                id: 18,
                name: "Toronto Kalibari",
                dates: "27th to 1st Oct",
                address: "6815 Professional Ct, Mississauga",
                facebook: "https://www.kalibaritoronto.com/"
            },
            {
                id: 19,
                name: "Utsav Bengali Association London",
                dates: "4th - 5th Oct",
                address: "John Paul II Secondary School, London ON",
                facebook: "https://www.facebook.com/groups/utsavontario"
            },
            {
                id: 20,
                name: "Vedanta Society of Toronto",
                dates: "27th Sep to 1st Oct",
                address: "Ramkrishna Mission - 120 Emmett Ave, York",
                facebook: "https://vedantatoronto.ca/special-events"
            },
            {
                id: 21,
                name: "Niagara Sharodiya",
                dates: "4th - 5th Oct",
                address: "2691 Portage Road, Niagara Falls",
                facebook: "https://www.facebook.com/profile.php?id=100094011860205"
            }
        ];

        // ===== SEARCH AND SORT FUNCTIONALITY =====
        document.addEventListener('DOMContentLoaded', function() {
            const searchInput = document.getElementById('searchInput');
            const sortSelect = document.getElementById('sortSelect');
            const resultCount = document.getElementById('resultCount');
            
            // Search functionality
            searchInput.addEventListener('input', handleSearch);
            sortSelect.addEventListener('change', handleSearch);
            
            // Itinerary functionality
            initializeItinerary();
            
            // Initialize map
            initializeMap();
            
            // Initial render
            handleSearch();
        });

        function handleSearch() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const sortBy = document.getElementById('sortSelect').value;
            
            let filteredPujas = pujaData.filter(puja => 
                puja.name.toLowerCase().includes(searchTerm) ||
                puja.address.toLowerCase().includes(searchTerm) ||
                puja.dates.toLowerCase().includes(searchTerm)
            );
            
            // Sort the filtered results
            filteredPujas.sort((a, b) => {
                if (sortBy === 'name') {
                    return a.name.localeCompare(b.name);
                } else if (sortBy === 'date') {
                    const dateA = getDateValue(a.dates);
                    const dateB = getDateValue(b.dates);
                    return dateA - dateB;
                }
                return 0;
            });
            
            // Update result count
            document.getElementById('resultCount').textContent = filteredPujas.length;
            
            // Render the results
            renderTable(filteredPujas);
            renderCards(filteredPujas);
        }

        function getDateValue(dateStr) {
            if (dateStr.includes('Sep')) return 1;
            if (dateStr.includes('Oct')) return 2;
            if (dateStr.includes('TBA')) return 999;
            return 0;
        }

        function renderTable(pujas) {
            const tableBody = document.getElementById('pujaTableBody');
            if (!tableBody) return;
            
            tableBody.innerHTML = pujas.map(puja => {
                const googleMapsUrl = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(puja.address)}`;
                return `
                    <tr>
                        <td>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" value="${puja.id}" id="puja${puja.id}" onchange="handleCheckboxChange(${puja.id}, this.checked)">
                            </div>
                        </td>
                        <td>${puja.name}</td>
                        <td>${puja.dates}</td>
                        <td>
                            <a href="${googleMapsUrl}" target="_blank" class="text-decoration-none">
                                <i class="fas fa-map-marker-alt text-danger"></i> ${puja.address}
                            </a>
                        </td>
                        <td>
                            ${puja.facebook ? 
                                `<a href="${puja.facebook}" target="_blank" class="btn btn-sm btn-outline-primary">
                                    <i class="${puja.facebook.includes('facebook.com') ? 'fab fa-facebook' : 'fas fa-globe'}"></i> ${puja.facebook.includes('facebook.com') ? 'Facebook' : 'Website'}
                                </a>` : 
                                '<span class="text-muted">No link available</span>'
                            }
                        </td>
                    </tr>
                `;
            }).join('');
        }

        function renderCards(pujas) {
            const cardsContainer = document.getElementById('pujaCards');
            if (!cardsContainer) return;
            
            cardsContainer.innerHTML = pujas.map(puja => {
                const googleMapsUrl = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(puja.address)}`;
                return `
                    <div class="col-md-6 col-lg-4 mb-4">
                        <div class="card h-100 puja-card">
                            <div class="card-body">
                                <div class="form-check mb-3">
                                    <input class="form-check-input" type="checkbox" value="${puja.id}" id="cardPuja${puja.id}" onchange="handleCheckboxChange(${puja.id}, this.checked)">
                                    <label class="form-check-label" for="cardPuja${puja.id}">
                                        <h5 class="card-title">${puja.name}</h5>
                                    </label>
                                </div>
                                <p class="card-text">
                                    <strong>Dates:</strong> ${puja.dates}<br>
                                    <strong>Address:</strong> 
                                    <a href="${googleMapsUrl}" target="_blank" class="text-decoration-none">
                                        <i class="fas fa-map-marker-alt text-danger"></i> ${puja.address}
                                    </a>
                                </p>
                                ${puja.facebook ? 
                                    `<a href="${puja.facebook}" target="_blank" class="btn btn-festive">
                                        <i class="${puja.facebook.includes('facebook.com') ? 'fab fa-facebook' : 'fas fa-globe'}"></i> ${puja.facebook.includes('facebook.com') ? 'Facebook Page' : 'Website'}
                                    </a>` : 
                                    '<span class="text-muted">No link available</span>'
                                }
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        // ===== ITINERARY FUNCTIONALITY =====
        let selectedPujas = [];

        function initializeItinerary() {
            const itineraryBtn = document.getElementById('itineraryBtn');
            const closeSidebar = document.getElementById('closeSidebar');
            const sidebarOverlay = document.getElementById('sidebarOverlay');
            
            // Itinerary sidebar
            itineraryBtn.addEventListener('click', toggleSidebar);
            closeSidebar.addEventListener('click', closeItinerarySidebar);
            sidebarOverlay.addEventListener('click', closeItinerarySidebar);

            // Share functionality
            document.getElementById('shareWhatsApp').addEventListener('click', shareToWhatsApp);
            document.getElementById('shareFacebook').addEventListener('click', shareToFacebook);
            document.getElementById('shareEmail').addEventListener('click', shareToEmail);
            document.getElementById('copyText').addEventListener('click', copyItineraryText);
        }

        function toggleSidebar() {
            const sidebar = document.getElementById('itinerarySidebar');
            const overlay = document.getElementById('sidebarOverlay');
            
            sidebar.classList.toggle('open');
            overlay.classList.toggle('active');
        }

        function closeItinerarySidebar() {
            const sidebar = document.getElementById('itinerarySidebar');
            const overlay = document.getElementById('sidebarOverlay');
            
            sidebar.classList.remove('open');
            overlay.classList.remove('active');
        }

        function updateItinerary() {
            const itineraryList = document.getElementById('itineraryList');
            const sidebarActions = document.getElementById('sidebarActions');
            const itineraryCount = document.getElementById('itineraryCount');
            
            if (selectedPujas.length === 0) {
                itineraryList.innerHTML = '<p class="text-muted text-center">No pujas selected yet</p>';
                sidebarActions.style.display = 'none';
            } else {
                itineraryList.innerHTML = selectedPujas.map(puja => `
                    <div class="itinerary-item">
                        <h6>${puja.name}</h6>
                        <p><strong>Dates:</strong> ${puja.dates}</p>
                        <p><strong>Location:</strong> ${puja.address}</p>
                        <button class="btn btn-sm btn-outline-danger" onclick="removeFromItinerary(${puja.id})">
                            <i class="fas fa-times"></i> Remove
                        </button>
                    </div>
                `).join('');
                sidebarActions.style.display = 'block';
            }
            
            itineraryCount.textContent = selectedPujas.length;
        }

        function addToItinerary(pujaId) {
            const puja = pujaData.find(p => p.id === pujaId);
            if (puja && !selectedPujas.find(p => p.id === pujaId)) {
                selectedPujas.push(puja);
                updateItinerary();
            }
        }

        function removeFromItinerary(pujaId) {
            selectedPujas = selectedPujas.filter(p => p.id !== pujaId);
            updateItinerary();
            
            // Uncheck the checkbox
            const checkbox = document.getElementById(`puja${pujaId}`);
            const cardCheckbox = document.getElementById(`cardPuja${pujaId}`);
            if (checkbox) checkbox.checked = false;
            if (cardCheckbox) cardCheckbox.checked = false;
        }

        function handleCheckboxChange(pujaId, isChecked) {
            if (isChecked) {
                addToItinerary(pujaId);
            } else {
                removeFromItinerary(pujaId);
            }
        }

        function shareToWhatsApp() {
            const text = generateItineraryText();
            const url = `https://wa.me/?text=${encodeURIComponent(text)}`;
            window.open(url, '_blank');
        }

        function shareToFacebook() {
            const text = generateItineraryText();
            const url = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(window.location.href)}&quote=${encodeURIComponent(text)}`;
            window.open(url, '_blank');
        }

        function shareToEmail() {
            const text = generateItineraryText();
            const subject = "My Durga Puja 2025 Itinerary";
            const body = text;
            const url = `mailto:?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
            window.open(url);
        }

        function copyItineraryText() {
            const text = generateItineraryText();
            navigator.clipboard.writeText(text).then(() => {
                // Show success message
                const btn = document.getElementById('copyText');
                const originalText = btn.innerHTML;
                btn.innerHTML = '<i class="fas fa-check"></i> Copied!';
                btn.style.background = '#28a745';
                
                setTimeout(() => {
                    btn.innerHTML = originalText;
                    btn.style.background = '';
                }, 2000);
            }).catch(err => {
                console.error('Failed to copy text: ', err);
                alert('Failed to copy text. Please try again.');
            });
        }

        function generateItineraryText() {
            let text = "🎉 My Durga Puja 2025 Itinerary 🎉\n\n";
            selectedPujas.forEach((puja, index) => {
                text += `${index + 1}. ${puja.name}\n`;
                text += `   📅 Dates: ${puja.dates}\n`;
                text += `   📍 Location: ${puja.address}\n`;
                text += `   🔗 ${puja.facebook.includes('facebook.com') ? 'Facebook' : 'Website'}: ${puja.facebook}\n\n`;
            });
            text += "Happy Durga Puja! 🕉️";
            return text;
        }

        // ===== INTERACTIVE MAP FUNCTIONALITY =====
        let pujaMap;
        let mapMarkers = [];

        function initializeMap() {
            // Initialize the map centered on GTA area
            pujaMap = L.map('pujaMap').setView([43.6532, -79.3832], 10);

            // Add OpenStreetMap tiles
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '© OpenStreetMap contributors'
            }).addTo(pujaMap);

            // Add markers for all pujas
            addPujaMarkers();
        }

        function addPujaMarkers() {
            // Clear existing markers
            mapMarkers.forEach(marker => pujaMap.removeLayer(marker));
            mapMarkers = [];

            pujaData.forEach((puja, index) => {
                // Geocode the address to get coordinates
                geocodeAddress(puja.address, (lat, lng) => {
                    if (lat && lng) {
                        // Create custom marker with area-based color
                        const markerColor = getMarkerColor(puja.address);
                        const marker = L.marker([lat, lng], {
                            icon: L.divIcon({
                                className: 'custom-marker',
                                html: `<div class="custom-marker" style="background-color: ${markerColor};">${index + 1}</div>`,
                                iconSize: [30, 30],
                                iconAnchor: [15, 15]
                            })
                        });

                        // Create popup content
                        const popupContent = createPopupContent(puja);
                        marker.bindPopup(popupContent);

                        // Add marker to map
                        marker.addTo(pujaMap);
                        mapMarkers.push(marker);
                    }
                });
            });
        }

        // Predefined coordinates for major GTA areas
        const gtaCoordinates = {
            'Toronto': [43.6532, -79.3832],
            'Scarborough': [43.7731, -79.2578],
            'North York': [43.7615, -79.4111],
            'Etobicoke': [43.6435, -79.5656],
            'York': [43.6938, -79.5029],
            'East York': [43.6905, -79.3277],
            'Mississauga': [43.5890, -79.6441],
            'Brampton': [43.6834, -79.7663],
            'Markham': [43.8668, -79.2663],
            'Richmond Hill': [43.8828, -79.4403],
            'Vaughan': [43.8361, -79.4983],
            'Ajax': [43.8508, -79.0203],
            'Pickering': [43.8354, -79.0863],
            'Whitby': [43.8975, -78.9428],
            'Oshawa': [43.8971, -78.8658],
            'Waterloo': [43.4643, -80.5204],
            'Guelph': [43.5448, -80.2482],
            'London': [42.9849, -81.2453],
            'Hamilton': [43.2557, -79.8711],
            'Oakville': [43.4675, -79.6877],
            'Burlington': [43.3255, -79.7990],
            'Niagara Falls': [43.0896, -79.0849]
        };

        function geocodeAddress(address, callback) {
            // First try to find coordinates based on city names in the address
            const cityMatch = findCityInAddress(address);
            if (cityMatch) {
                callback(cityMatch[0], cityMatch[1]);
                return;
            }

            // Use Nominatim (OpenStreetMap's geocoding service) - free, no API key required
            const url = `https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(address + ', Ontario, Canada')}&limit=1`;
            
            fetch(url)
                .then(response => response.json())
                .then(data => {
                    if (data && data.length > 0) {
                        const lat = parseFloat(data[0].lat);
                        const lng = parseFloat(data[0].lon);
                        // Validate coordinates are in reasonable GTA area
                        if (lat >= 43.0 && lat <= 44.5 && lng >= -80.5 && lng <= -78.5) {
                            callback(lat, lng);
                        } else {
                            // Use fallback coordinates for the area
                            const fallback = getFallbackCoordinates(address);
                            callback(fallback[0], fallback[1]);
                        }
                    } else {
                        // Use fallback coordinates for the area
                        const fallback = getFallbackCoordinates(address);
                        callback(fallback[0], fallback[1]);
                    }
                })
                .catch(error => {
                    console.log('Geocoding error:', error);
                    // Use fallback coordinates for the area
                    const fallback = getFallbackCoordinates(address);
                    callback(fallback[0], fallback[1]);
                });
        }

        function findCityInAddress(address) {
            const addressLower = address.toLowerCase();
            for (const [city, coords] of Object.entries(gtaCoordinates)) {
                if (addressLower.includes(city.toLowerCase())) {
                    return coords;
                }
            }
            return null;
        }

        function getFallbackCoordinates(address) {
            const cityMatch = findCityInAddress(address);
            if (cityMatch) {
                // Add small random offset to avoid overlapping markers
                const offsetLat = (Math.random() - 0.5) * 0.01;
                const offsetLng = (Math.random() - 0.5) * 0.01;
                return [cityMatch[0] + offsetLat, cityMatch[1] + offsetLng];
            }
            // Default to Toronto if no city found
            return [43.6532, -79.3832];
        }

        function getMarkerColor(address) {
            const addressLower = address.toLowerCase();
            
            // Color coding by region
            if (addressLower.includes('toronto') || addressLower.includes('scarborough') || 
                addressLower.includes('north york') || addressLower.includes('etobicoke') || 
                addressLower.includes('york') || addressLower.includes('east york')) {
                return '#d32f2f'; // Red for Toronto area
            } else if (addressLower.includes('mississauga') || addressLower.includes('brampton') || 
                       addressLower.includes('oakville') || addressLower.includes('burlington')) {
                return '#1976d2'; // Blue for Peel/Halton region
            } else if (addressLower.includes('markham') || addressLower.includes('richmond hill') || 
                       addressLower.includes('vaughan')) {
                return '#388e3c'; // Green for York region
            } else if (addressLower.includes('ajax') || addressLower.includes('pickering') || 
                       addressLower.includes('whitby') || addressLower.includes('oshawa')) {
                return '#f57c00'; // Orange for Durham region
            } else if (addressLower.includes('waterloo') || addressLower.includes('guelph')) {
                return '#7b1fa2'; // Purple for Waterloo region
            } else if (addressLower.includes('london')) {
                return '#5d4037'; // Brown for London
            } else if (addressLower.includes('hamilton')) {
                return '#455a64'; // Blue-grey for Hamilton
            } else if (addressLower.includes('niagara')) {
                return '#e91e63'; // Pink for Niagara
            } else {
                return '#d32f2f'; // Default red
            }
        }

        function createPopupContent(puja) {
            const googleMapsUrl = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(puja.address)}`;
            const linkType = puja.facebook.includes('facebook.com') ? 'Facebook' : 'Website';
            const linkIcon = puja.facebook.includes('facebook.com') ? 'fab fa-facebook' : 'fas fa-globe';
            const linkClass = puja.facebook.includes('facebook.com') ? 'btn-facebook' : 'btn-website';

            return `
                <div class="popup-content">
                    <div class="popup-title">${puja.name}</div>
                    <div class="popup-details">
                        <p><strong>📅 Dates:</strong> ${puja.dates}</p>
                        <p><strong>📍 Address:</strong> ${puja.address}</p>
                    </div>
                    <div class="popup-actions">
                        <a href="${googleMapsUrl}" target="_blank" class="popup-btn btn-directions">
                            <i class="fas fa-directions"></i> Directions
                        </a>
                        ${puja.facebook ? `
                            <a href="${puja.facebook}" target="_blank" class="popup-btn ${linkClass}">
                                <i class="${linkIcon}"></i> ${linkType}
                            </a>
                        ` : ''}
                    </div>
                </div>
            `;
        }

        // ===== RESPONSIVE BEHAVIOR =====
        window.addEventListener('resize', function() {
            // Handle responsive behavior if needed
            if (pujaMap) {
                setTimeout(() => {
                    pujaMap.invalidateSize();
                }, 100);
            }
        });
    </script>
</body>
</html>
